{
  "downs": 0,
  "mod_reports": [],
  "secure_media_embed": {},
  "_info_url": "https://api.reddit.com/api/info/",
  "gilded": 0,
  "num_comments": 301,
  "_orphaned": {},
  "hidden": false,
  "ups": 407,
  "url": "https://www.reddit.com/r/engineering/comments/3mppqp/i_work_in_diesel_emissions_not_at_vw_some/",
  "_has_fetched": true,
  "quarantine": false,
  "name": "t3_3mppqp",
  "user_reports": [],
  "saved": false,
  "permalink": "https://www.reddit.com/r/engineering/comments/3mppqp/i_work_in_diesel_emissions_not_at_vw_some/?ref=search_posts",
  "over_18": false,
  "is_self": true,
  "_params": {},
  "thumbnail": "self",
  "created_utc": 1443459999.0,
  "_replaced_more": false,
  "selftext_html": "<!-- SC_OFF --><div class=\"md\"><p>Watching this VW thing unfold has been like watching the last ~10 years of my work show show up in main stream media. We&#39;re usually the guys that no one remembers exists.</p>\n\n<p>I don&#39;t work at VW, but at a contemporary. As soon as I heard about what they were accused of doing I thought about how I would do something similar. I can&#39;t guarantee this is <em>exactly</em> how VW does it, but just looking at <a href=\"http://www.indeed.com/q-Calibration-Diesel-Engineer-Engineer-jobs.html\">Indeed it&#39;s how a large number of companies do it.</a></p>\n\n<ol>\n<li><p>IMHO, forget any &quot;it was an an accident&quot;. It&#39;s hard enough to make things work the way you want them to as is. This went through no more than a dozen people for multiple stages of development.</p></li>\n<li><p>There are really only 3 OEMs for Diesel ECMs: <a href=\"http://imgur.com/pPpn1DC\">Bosch, Denso &amp; Delphi</a>. VW isn&#39;t running their own custom hardware, they outsource it to Bosch. The latest Bosch diesel ECM is the EDC17.</p></li>\n<li><p>The EDC17 is running a <a href=\"http://www.infineon.com/cms/en/product/microcontroller/32-bit-tricore-tm-microcontroller/channel.html?channel=ff80808112ab681d0112ab6b64b50805\">Infineon 32-Bit Tricore uC</a>.</p></li>\n<li><p>The ECMs is most likely through <a href=\"http://www.mathworks.com/products/connections/product_detail/product_35878.html\">Simulink</a> (Ours is). There are a few companies that provide <a href=\"http://www.infineon.com/cms/en/product/microcontroller/development-tools-software-and-kits/tricore-tm-development-tools-software-and-kits/simulation/modelling/channel.html?channel=ff80808112ab681d0112ab6b596207e5\">Simulink/Matlab support</a>.</p></li>\n<li><p>ECMs are tuned through <a href=\"https://vector.com/vi_canape_en.html\">VectorCANape</a>. Everyone I know of uses CANape. As far as I know there isn&#39;t really any competitors. <a href=\"https://www.youtube.com/watch?v=OrlCRuHr0XQ&amp;list=PL36EEEC4559038DF6\">Here&#39;s a youtube video showing the &#39;latest features&#39; of CANape12</a>. (When I started we were stuck with CANape 6.5 for ages).</p></li>\n<li><p>A decade ago there may have been 10-20 adjustment maps. Temperature, boost pressure, barometric pressure, coolant temperature, etc. Now there are dozens if not hundreds of maps. At $10k/hr+ for test cell time you don&#39;t &#39;accidentally&#39; calibrate a map that you don&#39;t need.</p></li>\n<li><p>The EPA has mandated that I have to try and defeat you defeating me. This includes encrypting everything, checking if you try and remove the DPF or EGR, etc.</p></li>\n</ol>\n\n<p>Edit: Some more things.</p>\n\n<p>8. Not sure who VW uses but there are only <a href=\"http://www.infineon.com/cms/en/product/microcontroller/development-tools-software-and-kits/tricore-tm-development-tools-software-and-kits/compiler-tool-chains/channel.html?channel=ff80808112ab681d0112ab6b55d607d9\">3 compilers for the Infineon Tricore.</a>. All of support of any of those compilers doesn&#39;t come cheap either.</p>\n\n<p>9. I&#39;ve found <em>some</em> documentation that the EDC17 is <a href=\"https://en.wikipedia.org/wiki/AUTOSAR\">AUTOSAR</a> compliant. However a lot of this documentation is under NDA so it&#39;s hard to find decent information on Google.</p>\n\n<p>10. The EDC17 is <em>9</em> years old. Once you get something working you stop trying to be the &#39;newest&#39;. You can&#39;t just toss a RaspPi or Adruino under the hood to run these things. Under the hood with diesel engines in one of the worst environments. It shakes, it&#39;s dirty, you have to be able to handle a lot of stray voltages. </p>\n\n<p>11. If this is stuff that interests you and you want to go into this industry as a living:</p>\n\n<ul>\n<li><p>EE&#39;s look into the <a href=\"http://www.st.com/web/en/catalog/sense_power/FM2098/SC963?icmp=sc963_pron_launch-eiger_apr2015&amp;sc=spc5-pr1\">ST SPC5-32bit</a> chips/boards or the <a href=\"http://cache.freescale.com/files/32bit/doc/white_paper/E200CORELCNWP.pdf\">FreeScale e200</a>/<a href=\"http://www.freescale.com/products/power-architecture-processors/mpc5xxx-5xxx-32-bit-mcus/mpc56xx-mcus:MPC56XX?cof=0&amp;am=0\">Freescale MPC56xx</a>.</p></li>\n<li><p>ME&#39;s, <a href=\"http://ctms.engin.umich.edu/CTMS/index.php?example=AircraftPitch&amp;section=SimulinkModeling\">learn Simulink</a>. Inside and out. <a href=\"https://en.wikipedia.org/wiki/Model-based_design\">Model based control</a> is becoming the industry standard. As far as I know everyone uses some variant <a href=\"http://www.mathworks.com/tagteam/20303_91198_Caterpillar_2004-01-0894.pdf\">of what Caterpllar published</a> they do in 2004. That stuff is mature enough to be in the <a href=\"http://www.mathworks.com/company/user_stories/airbus-helicopters-accelerates-development-of-do-178b-certified-software-with-model-based-design.html?by=product\">Aerospace industry</a>. Those non-Free compilers <a href=\"http://www.mathworks.com/hardware-support/vxworks.html\">go &quot;out of their way&quot;</a> to support Simulink. <a href=\"http://www.mathworks.com/company/user_stories/matlab-and-simulink-help-land-unpiloted-boeing-spacecraft.html?by=product\">Boeing</a>, <a href=\"http://www.mathworks.com/company/user_stories/video-using-model-based-design-bell-helicopter-creates-the-worlds-first-civilian-tiltrotor.html?by=product\">Bell Helicopter</a>, <a href=\"http://www.mathworks.com/company/user_stories/abb-accelerates-application-control-software-development-for-a-power-electronic-controller.html?by=product\">ABB</a>, <a href=\"http://www.mathworks.com/company/user_stories/daimler-designs-cruise-controller-for-mercedes-benz-trucks.html?by=product\">Daimler</a>, <a href=\"http://www.mathworks.com/company/user_stories/nasa-marshall-space-flight-center-internship-program.html?by=product\">NASA</a>, etc.</p></li>\n</ul>\n\n<p>12. Learn about eTPU&#39;s. <a href=\"http://www.freescale.com/webapp/etpu/\">FreeScale has some precompiled</a> functions. As far as I know there isn&#39;t a free eTPU compiler. There&#39;s <a href=\"https://www.ashware.com/\">Ashware</a> and <a href=\"http://www.bytecraft.com/eTPU_C\">Bytecraft</a>.</p>\n\n<p>Also, if there are any EE hardware engineers out there that would like to develop a modern diesel ECM for 4-6 cylinder engines. From rotary pump, <a href=\"https://en.wikipedia.org/wiki/Unit_injector\">Pumpe D\u00fcse&quot;</a>, to<a href=\"http://de.bosch-automotive.com/en/parts/parts_and_accessories/motor_and_sytems/diesel/common_rail_injection/common_rail_diesel_motorsys_parts\">Common Rail</a>... PM me. MegaSquirt is ~20 years behind industry. </p>\n</div><!-- SC_ON -->",
  "subreddit_id": "t5_2qhpi",
  "archived": false,
  "domain": "self.engineering",
  "clicked": false,
  "score": 407,
  "link_flair_text": "[MECHANICAL]",
  "id": "3mppqp",
  "stickied": false,
  "media_embed": {},
  "post_hint": "self",
  "link_flair_css_class": "mec",
  "visited": false,
  "selftext": "Watching this VW thing unfold has been like watching the last ~10 years of my work show show up in main stream media. We're usually the guys that no one remembers exists.\n\nI don't work at VW, but at a contemporary. As soon as I heard about what they were accused of doing I thought about how I would do something similar. I can't guarantee this is *exactly* how VW does it, but just looking at [Indeed it's how a large number of companies do it.](http://www.indeed.com/q-Calibration-Diesel-Engineer-Engineer-jobs.html)\n\n1. IMHO, forget any \"it was an an accident\". It's hard enough to make things work the way you want them to as is. This went through no more than a dozen people for multiple stages of development.\n\n2. There are really only 3 OEMs for Diesel ECMs: [Bosch, Denso & Delphi](http://imgur.com/pPpn1DC). VW isn't running their own custom hardware, they outsource it to Bosch. The latest Bosch diesel ECM is the EDC17.\n\n3. The EDC17 is running a [Infineon 32-Bit Tricore uC](http://www.infineon.com/cms/en/product/microcontroller/32-bit-tricore-tm-microcontroller/channel.html?channel=ff80808112ab681d0112ab6b64b50805).\n\n4. The ECMs is most likely through [Simulink](http://www.mathworks.com/products/connections/product_detail/product_35878.html) (Ours is). There are a few companies that provide [Simulink/Matlab support](http://www.infineon.com/cms/en/product/microcontroller/development-tools-software-and-kits/tricore-tm-development-tools-software-and-kits/simulation/modelling/channel.html?channel=ff80808112ab681d0112ab6b596207e5).\n\n5. ECMs are tuned through [VectorCANape](https://vector.com/vi_canape_en.html). Everyone I know of uses CANape. As far as I know there isn't really any competitors. [Here's a youtube video showing the 'latest features' of CANape12](https://www.youtube.com/watch?v=OrlCRuHr0XQ&list=PL36EEEC4559038DF6). (When I started we were stuck with CANape 6.5 for ages).\n\n6. A decade ago there may have been 10-20 adjustment maps. Temperature, boost pressure, barometric pressure, coolant temperature, etc. Now there are dozens if not hundreds of maps. At $10k/hr+ for test cell time you don't 'accidentally' calibrate a map that you don't need.\n\n7. The EPA has mandated that I have to try and defeat you defeating me. This includes encrypting everything, checking if you try and remove the DPF or EGR, etc.\n\nEdit: Some more things.\n\n8\\. Not sure who VW uses but there are only [3 compilers for the Infineon Tricore.](http://www.infineon.com/cms/en/product/microcontroller/development-tools-software-and-kits/tricore-tm-development-tools-software-and-kits/compiler-tool-chains/channel.html?channel=ff80808112ab681d0112ab6b55d607d9). All of support of any of those compilers doesn't come cheap either.\n\n9\\. I've found *some* documentation that the EDC17 is [AUTOSAR](https://en.wikipedia.org/wiki/AUTOSAR) compliant. However a lot of this documentation is under NDA so it's hard to find decent information on Google.\n\n10\\. The EDC17 is *9* years old. Once you get something working you stop trying to be the 'newest'. You can't just toss a RaspPi or Adruino under the hood to run these things. Under the hood with diesel engines in one of the worst environments. It shakes, it's dirty, you have to be able to handle a lot of stray voltages. \n\n11\\. If this is stuff that interests you and you want to go into this industry as a living:\n\n- EE's look into the [ST SPC5-32bit](http://www.st.com/web/en/catalog/sense_power/FM2098/SC963?icmp=sc963_pron_launch-eiger_apr2015&sc=spc5-pr1) chips/boards or the [FreeScale e200](http://cache.freescale.com/files/32bit/doc/white_paper/E200CORELCNWP.pdf)/[Freescale MPC56xx](http://www.freescale.com/products/power-architecture-processors/mpc5xxx-5xxx-32-bit-mcus/mpc56xx-mcus:MPC56XX?cof=0&am=0).\n\n- ME's, [learn Simulink](http://ctms.engin.umich.edu/CTMS/index.php?example=AircraftPitch&section=SimulinkModeling). Inside and out. [Model based control](https://en.wikipedia.org/wiki/Model-based_design) is becoming the industry standard. As far as I know everyone uses some variant [of what Caterpllar published](http://www.mathworks.com/tagteam/20303_91198_Caterpillar_2004-01-0894.pdf) they do in 2004. That stuff is mature enough to be in the [Aerospace industry](http://www.mathworks.com/company/user_stories/airbus-helicopters-accelerates-development-of-do-178b-certified-software-with-model-based-design.html?by=product). Those non-Free compilers [go \"out of their way\"](http://www.mathworks.com/hardware-support/vxworks.html) to support Simulink. [Boeing](http://www.mathworks.com/company/user_stories/matlab-and-simulink-help-land-unpiloted-boeing-spacecraft.html?by=product), [Bell Helicopter](http://www.mathworks.com/company/user_stories/video-using-model-based-design-bell-helicopter-creates-the-worlds-first-civilian-tiltrotor.html?by=product), [ABB](http://www.mathworks.com/company/user_stories/abb-accelerates-application-control-software-development-for-a-power-electronic-controller.html?by=product), [Daimler](http://www.mathworks.com/company/user_stories/daimler-designs-cruise-controller-for-mercedes-benz-trucks.html?by=product), [NASA](http://www.mathworks.com/company/user_stories/nasa-marshall-space-flight-center-internship-program.html?by=product), etc.\n\n12\\. Learn about eTPU's. [FreeScale has some precompiled](http://www.freescale.com/webapp/etpu/) functions. As far as I know there isn't a free eTPU compiler. There's [Ashware](https://www.ashware.com/) and [Bytecraft](http://www.bytecraft.com/eTPU_C).\n\nAlso, if there are any EE hardware engineers out there that would like to develop a modern diesel ECM for 4-6 cylinder engines. From rotary pump, [Pumpe D\u00fcse\"](https://en.wikipedia.org/wiki/Unit_injector), to[Common Rail](http://de.bosch-automotive.com/en/parts/parts_and_accessories/motor_and_sytems/diesel/common_rail_injection/common_rail_diesel_motorsys_parts)... PM me. MegaSquirt is ~20 years behind industry. ",
  "hide_score": false,
  "_api_link": "https://api.reddit.com/r/engineering/comments/3mppqp/i_work_in_diesel_emissions_not_at_vw_some/?ref=search_posts",
  "locked": false,
  "edited": 1443458910.0,
  "preview": {
    "images": [
      {
        "variants": {},
        "id": "eBBBcwe6SkvI8YauvKT17u50iUDXFMd-CagiqtLQe6U",
        "source": {
          "url": "https://i.redditmedia.com/RBerd8JP0CI-KJBPTJRQVDwC_DU--VY-7e4jIMHsAYk.jpg?s=1d97ed5f2e6138dfd0b367b09ae2ac13",
          "height": 362,
          "width": 857
        },
        "resolutions": [
          {
            "url": "https://i.redditmedia.com/RBerd8JP0CI-KJBPTJRQVDwC_DU--VY-7e4jIMHsAYk.jpg?fit=crop&crop=faces%2Centropy&arh=2&w=108&s=d99f4e2eba3e675fb2f8058bb7cfcc88",
            "height": 45,
            "width": 108
          },
          {
            "url": "https://i.redditmedia.com/RBerd8JP0CI-KJBPTJRQVDwC_DU--VY-7e4jIMHsAYk.jpg?fit=crop&crop=faces%2Centropy&arh=2&w=216&s=fbf720d60b37b15c5dbe0749cc3976fc",
            "height": 91,
            "width": 216
          },
          {
            "url": "https://i.redditmedia.com/RBerd8JP0CI-KJBPTJRQVDwC_DU--VY-7e4jIMHsAYk.jpg?fit=crop&crop=faces%2Centropy&arh=2&w=320&s=b3582793f3a0c4ca556e73e5aafb0486",
            "height": 135,
            "width": 320
          },
          {
            "url": "https://i.redditmedia.com/RBerd8JP0CI-KJBPTJRQVDwC_DU--VY-7e4jIMHsAYk.jpg?fit=crop&crop=faces%2Centropy&arh=2&w=640&s=aead3752686f1da8cf9b0a9b538177a9",
            "height": 270,
            "width": 640
          }
        ]
      }
    ]
  },
  "title": "I work in Diesel Emissions (not at VW), some information about our niche and AMA.",
  "created": 1443459999.0,
  "_comments_by_id": {}
}